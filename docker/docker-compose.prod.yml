version: '3.8'

services:
  nginx:
    build:
      context: ./docker/nginx
      dockerfile: Dockerfile
    image: slowfall-proxy:local
    ports:
      - "8080:80"
    environment:
      - BACKEND_HOST=backend
      - BACKEND_PORT=8080
      - CLIENT_MAX_BODY_SIZE=20m
      - PROXY_READ_TIMEOUT=90s
      - PROXY_SEND_TIMEOUT=90s
    volumes:
      - static_content:/usr/share/nginx/html:ro

  backend:
    image: ghcr.io/soda-xyz/slowfall-backend:latest
    environment:
      - PORT=8080
    expose:
      - "8080"

volumes:
  static_content:
    driver: local
